<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles.css">
    <title>Book Details</title>
    <script>
        async function loadBookDetails() {
            const urlParams = new URLSearchParams(window.location.search);
            const isbn = urlParams.get('isbn');

            if (!isbn) {
                document.getElementById('bookDetails').innerText = "Book not found.";
                return;
            }

            // Fetch book info from Google Books API
            const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=isbn:${isbn}`);
            const data = await response.json();
            const book = data.items ? data.items[0].volumeInfo : null;

            if (book) {
                document.getElementById('bookTitle').innerText = book.title;
                document.getElementById('bookAuthor').innerText = `Author: ${book.authors ? book.authors.join(', ') : 'Unknown'}`;
                document.getElementById('bookDescription').innerText = book.description || "No description available.";
                document.getElementById('bookPublisher').innerText = `Publisher: ${book.publisher || "N/A"}`;
                document.getElementById('bookPublishedDate').innerText = `Published Date: ${book.publishedDate || "N/A"}`;
                document.getElementById('bookPageCount').innerText = `Page Count: ${book.pageCount || "N/A"}`;

                // Set the book image
                const bookImage = document.getElementById('bookImage');
                if (book.imageLinks && book.imageLinks.thumbnail) {
                    bookImage.src = book.imageLinks.thumbnail;
                    bookImage.alt = `Cover of ${book.title}`;
                } else {
                    bookImage.src = '/no-image-available.jpg'; // default image path
                    bookImage.alt = 'No cover available';
                }

                // Set up links to buy the book
                document.getElementById('buyLinks').innerHTML = `
                    <a href="https://www.amazon.com/s?k=${book.title}" target="_blank">Buy on Amazon</a> |
                    <a href="https://www.barnesandnoble.com/s/${book.title}" target="_blank">Buy on Barnes & Noble</a>
                `;
            } else {
                document.getElementById('bookDetails').innerText = "Book details not available.";
            }
        }

        window.onload = loadBookDetails;
    </script>
</head>
<body>
<header>
    <nav>
        <button onclick="window.location.href='dashboard.html'">Back to Dashboard</button>
    </nav>
</header>

<div id="bookDetails">
    <img id="bookImage" alt="Book cover" />
    <h1 id="bookTitle">Book Title</h1>
    <p id="bookAuthor">Author</p>
    <p id="bookPublisher">Publisher</p>
    <p id="bookPublishedDate">Published Date</p>
    <p id="bookPageCount">Page Count</p>
    <p id="bookDescription">Description</p>
</div>

<h2>Where to Buy</h2>
<div id="buyLinks">
    <!-- Links will be populated dynamically based on the ISBN -->
</div>

</body>
</html>
